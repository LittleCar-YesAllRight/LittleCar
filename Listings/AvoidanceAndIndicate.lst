C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE AVOIDANCEANDINDICATE
OBJECT MODULE PLACED IN .\Objects\AvoidanceAndIndicate.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE AvoidanceAndIndicate.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\AvoidanceAndIndicate.lst) TABS(2) OBJECT(.\Objects\AvoidanceAndIndicate.obj)

line level    source

   1          #include "reg52.h"
   2          #define turn_time 1
   3          #define ABS_NOT(x) (x<0?~x:x)
   4          typedef signed char speed_t;
   5          // Êï∞Â≠óÁÅØ
   6          sbit led_S=P0^1;  // ‰∏≠Èó¥Êù†
   7          sbit led_LF=P0^2;  // Â∑¶ÂâçÊù†
   8          sbit led_LB=P0^3;  // Â∑¶ÂêéÊù†
   9          sbit led_B=P0^4;  // ÂêéÊù†
  10          sbit led_RB=P0^5;  // Âè≥ÂêéÊù†
  11          sbit led_RF=P0^6;  // Âè≥ÂâçÊù†
  12          sbit led_F=P0^7;  // ÂâçÊù†
  13          // È©¨Ëææ
  14          sbit moto_RF=P1^6;  // Âè≥ËΩÆÂêëÂâç 
  15          sbit moto_RB=P1^5;  // Âè≥ËΩÆÂêëÂêé
  16          sbit moto_LF=P1^4;  // Â∑¶ËΩÆÂêëÂâç
  17          sbit moto_LB=P1^3;  // Â∑¶ËΩÆÂêëÂêé
  18          // Á∫¢Â§ñÈÅøÈöú‰∏≤Âè£,ÊúâÈöúÁ¢ç‰∏∫0
  19          sbit lavoidance=P3^4;  // Â∑¶Á∫¢Â§ñ
  20          sbit ravoidance=P3^5;  // Âè≥Á∫¢Â§ñ
  21          // Â∑°Á∫ø‰∏≤Âè£, ÂéãÁ∫ø‰∏∫0
  22          sbit linspection=P3^7;  // Â∑¶Â∑°Á∫ø
  23          sbit rinspection=P3^6;  // Âè≥Â∑°Á∫ø
  24          void Delay(unsigned short);
  25          void CarRun(speed_t,speed_t);
  26          void FlashLED();
  27          void AvoidanceAndIndicate();
  28          void CarRunPro(signed char left_rate,signed char right_rate);
  29          
  30          int main(void)                                                                                            
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 2   

             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 3   

             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                         
  31          {
  32   1        CarRunPro(127,127);
  33   1        CarRunPro(-128,-128);
  34   1        //CarRunPro(0,0);
  35   1        //AvoidanceAndIndicate();
  36   1        while(1)
  37   1        {
  38   2          CarRunPro(127,127); // Ââç
  39   2          //Delay(400);
  40   2          //CarRunPro(0,0); // 
  41   2          //Delay(100);
  42   2          //CarRunPro(-128,127);  // Â∑¶
  43   2          //Delay(400);
  44   2          //CarRunPro(127,-128); // Âè≥
  45   2          //Delay(500);
  46   2          //CarRunPro(-128,-128);  // Âêé
  47   2          //Delay(500);
  48   2          
  49   2        }
  50   1      }
  51          
  52          // Â∑°Á∫øÂíåÈÅøÈöú
  53          void AvoidanceAndIndicate()
  54          {
  55   1        while(1)
  56   1        {
  57   2          // ÊãøÂú®Á©∫‰∏≠ ÊàñËÄÖ Á¢∞Âà∞ÈªëÁ∫ø Â∞±ÂÅú
  58   2          if(1==linspection && 1==rinspection)
  59   2          {
  60   3            CarRun('S','T');
  61   3            continue;
  62   3          }
  63   2          // ÈÅøÈöú
  64   2          if(1==lavoidance && 1==ravoidance && 0==linspection && 0==rinspection)  // Ê≤°ÊúâÈöúÁ¢ç,Âπ∂‰∏î‰∏çÂéãÁ∫ø
  65   2            CarRun('F','T');
  66   2          else if(0==lavoidance && 1==ravoidance)  // Â∑¶ËæπÊúâÈöúÁ¢ç
  67   2          {
  68   3            CarRun('R','T');
  69   3            //Delay(turn_time);
  70   3          }
  71   2          else if(1==lavoidance && 0==ravoidance)  // Âè≥ËæπÊúâÈöúÁ¢ç
  72   2          {
  73   3            CarRun('L','T');
  74   3            //Delay(turn_time);
  75   3          }
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 4   

  76   2          else if(0==lavoidance && 0==ravoidance)  // ÂâçÈù¢ÊúâÈöúÁ¢ç
  77   2          {
  78   3            CarRun('L','B');
  79   3          }
  80   2          //Â∑°Á∫ø
  81   2          if(0==linspection && 1==rinspection)
  82   2            CarRunPro(126,-126);
  83   2          else if(1==linspection && 0==rinspection)
  84   2            CarRunPro(-126,126);
  85   2        }
  86   1        
  87   1      }
  88          
  89          
  90          /***********************************
  91          *ÂáΩÊï∞ÂêçÁß∞:void Delay(unsigned short num)
  92          *ÂáΩÊï∞ÂäüËÉΩ:Âª∂Êó∂
  93          *ÂèÇÊï∞ËØ¥Êòé:num Âª∂Êó∂Êó∂Èó¥ ÂÄºÊúÄÂ§ß255
  94          
  95          ***********************************/
  96          void Delay(unsigned short num)
  97          {
  98   1          unsigned int temp=0;
  99   1          while(num--)
 100   1          {
 101   2              temp=2000;
 102   2              while(temp--);
 103   2          }
 104   1      }
 105          /**********************************
 106          ***********************************/
 107          
 108          
 109          /***********************************
 110          *ÂáΩÊï∞ÂêçÁß∞Ôºövoid CarRun(unsigned char dire)
 111          *ÂáΩÊï∞ÂäüËÉΩÔºöË°åËøõÊñπÂêëÊéßÂà∂
 112          *ÂèÇÊï∞ËØ¥ÊòéÔºödire ÊñπÂêë 'S'ÔºöÂÅúÊ≠¢   'F'ÔºöÂâç   'B'ÔºöÂêé   'L'ÔºöÂ∑¶   'R'ÔºöÂè≥
 113                     mode ËΩ¨ÂêëÊñπÂºè 'F'Ôºö‰∏ÄÂâç‰∏ÄÂÅú   'B'Ôºö‰∏ÄÂêé‰∏ÄÂÅú   'T'ÔºöÂù¶ÂÖãÂºèÔºå‰∏ÄÂâç‰∏ÄÂêé
 114          
 115          ***********************************/
 116          void CarRun(speed_t dire,speed_t mode)
 117          {
 118   1          switch (dire)
 119   1          {
 120   2              case 'S':             //ÂÅúÊ≠¢
 121   2                  CarRunPro(0,0);
 122   2                  break;
 123   2              case 'F':            //ÂâçËøõ
 124   2                  CarRunPro(126,126);
 125   2                  break;
 126   2              case 'B':            //ÂêéÈÄÄ 
 127   2                  CarRunPro(126,126);
 128   2            break;
 129   2              case 'L':            //Â∑¶ËΩ¨        
 130   2                  if('B'==mode)
 131   2                    CarRunPro(126,0);
 132   2                  if('F'==mode)
 133   2                    CarRunPro(0,126);
 134   2                  else
 135   2                    CarRunPro(126,126);
 136   2            break;
 137   2              case 'R':            //Âè≥ËΩ¨
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 5   

 138   2                  if('B'==mode)
 139   2                    CarRunPro(0,126);
 140   2                  if('F'==mode)
 141   2                    CarRunPro(126,0);
 142   2                  else
 143   2                    CarRunPro(126,126);
 144   2                  break;
 145   2          }
 146   1      }
 147          
 148          /**********************************
 149          ***********************************/
 150          
 151          /***********************************
 152          *ÂáΩÊï∞ÂêçÁß∞Ôºövoid CarRunPro(signed char left_rate,signed char right_rate)
 153          *ÂáΩÊï∞ÂäüËÉΩÔºöË°åËøõÊñπÂêëÁöÑÈ´òÁ∫ßÊéßÂà∂
 154          *ÂèÇÊï∞ËØ¥ÊòéÔºöleft_rate/right_rate(-128~127)Ë°®Á§∫Â∑¶/Âè≥ËΩÆË∑ëÁöÑÈÄüÂ∫¶,0/-1Ë°®Á§∫ÂÆåÂÖ®‰∏çËøêÂä®,ÂÆûÈô
             -Ö‰∏ä,Âè™ÊúâÊé•Ëøë126ËÉΩÈ©±Âä®
 155          
 156          ***********************************/
 157          unsigned int _ABS(int _origin){
 158   1        return _origin>0?_origin:-_origin;
 159   1      }
 160          void CarRunPro(speed_t left_rate,speed_t right_rate)
 161          {
 162   1        static speed_t l=0,r=0;
 163   1        if(l==0){
 164   2          switch(left_rate>0){
 165   3            case 1:
 166   3              moto_LF = 1;
 167   3              moto_LB = 0;
 168   3              break;
 169   3            case 0:
 170   3              moto_LB = 1;
 171   3              moto_LF = 0;
 172   3              break;
 173   3            default:
 174   3              moto_LF = 0;
 175   3              moto_LB = 0;
 176   3              break;
 177   3          }
 178   2        }
 179   1        if(r==0){
 180   2          switch(right_rate>0){
 181   3            case 1:
 182   3              moto_RF = 1;
 183   3              moto_RB = 0;
 184   3              break;
 185   3            case 0:
 186   3              moto_RB = 1;
 187   3              moto_RF = 0;
 188   3              break;
 189   3            default:
 190   3              moto_RB = 0;
 191   3              moto_RF = 0;
 192   3              break;
 193   3          }
 194   2        }
 195   1        //led_S=!((0==left_rate||0==left_rate)&&(0==right_rate||0==right_rate));// Â∑¶Âè≥ÁöÜÊ≠¢
 196   1        //led_LF=!(0<right_rate&&!(0<left_rate));// Âè≥ËøõÂ∑¶ËΩ¨
 197   1        //led_LB=!(0>left_rate&&!(0>right_rate));// Â∑¶ÈÄÄÂ∑¶ËΩ¨
 198   1        //led_B=!(0>left_rate&&0>right_rate);// ÂêéÈÄÄ
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 22:11:24 PAGE 6   

 199   1        //led_RB=!(!(0>left_rate)&&0>right_rate);// Âè≥ÈÄÄÂè≥ËΩ¨
 200   1        //led_RF=!(0<left_rate&&!(0<right_rate));// Â∑¶ËøõÂè≥ËΩ¨
 201   1        //led_F=!(0<left_rate&&0<right_rate);// ÂâçËøõ
 202   1        l++;
 203   1        r++;
 204   1        l%=(128-_ABS(left_rate));
 205   1        r%=(128-_ABS(right_rate));
 206   1      }
 207          /**********************************
 208          ***********************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    390    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
