C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 12:11:13 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE AVOIDANCEANDINDICATE
OBJECT MODULE PLACED IN .\Objects\AvoidanceAndIndicate.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE AvoidanceAndIndicate.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\AvoidanceAndIndicate.lst) TABS(2) OBJECT(.\Objects\AvoidanceAndIndicate.obj)

line level    source

   1          #include "reg52.h"
   2          #define turn_time 1
   3          #define ABS_NOT(x) (x<0?~x:x)
   4          // Êï∞Â≠óÁÅØ
   5          sbit led_S=P0^1;  // ‰∏≠Èó¥Êù†
   6          sbit led_LF=P0^2;  // Â∑¶ÂâçÊù†
   7          sbit led_LB=P0^3;  // Â∑¶ÂêéÊù†
   8          sbit led_B=P0^4;  // ÂêéÊù†
   9          sbit led_RB=P0^5;  // Âè≥ÂêéÊù†
  10          sbit led_RF=P0^6;  // Âè≥ÂâçÊù†
  11          sbit led_F=P0^7;  // ÂâçÊù†
  12          // È©¨Ëææ
  13          sbit moto_RF=P1^6;  // Âè≥ËΩÆÂêëÂâç 
  14          sbit moto_RB=P1^5;  // Âè≥ËΩÆÂêëÂêé
  15          sbit moto_LF=P1^4;  // Â∑¶ËΩÆÂêëÂâç
  16          sbit moto_LB=P1^3;  // Â∑¶ËΩÆÂêëÂêé
  17          // Á∫¢Â§ñÈÅøÈöú‰∏≤Âè£,ÊúâÈöúÁ¢ç‰∏∫0
  18          sbit lavoidance=P3^4;  // Â∑¶Á∫¢Â§ñ
  19          sbit ravoidance=P3^5;  // Âè≥Á∫¢Â§ñ
  20          // Â∑°Á∫ø‰∏≤Âè£, ÂéãÁ∫ø‰∏∫0
  21          sbit linspection=P3^7;  // Â∑¶Â∑°Á∫ø
  22          sbit rinspection=P3^6;  // Âè≥Â∑°Á∫ø
  23          void Delay(unsigned short num);
  24          void CarRun(unsigned char dire,unsigned char mode);
  25          void FlashLED();
  26          void AvoidanceAndIndicate();
  27          void CarRunPro(signed char left_rate,signed char right_rate);
  28          
  29          int main(void)                                                                                            
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 12:11:13 PAGE 2   

             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 12:11:13 PAGE 3   

             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                                                                                                                        
             -                         
  30          {
  31   1              
  32   1        AvoidanceAndIndicate();
  33   1        while(1);
  34   1      }
  35          
  36          // Â∑°Á∫øÂíåÈÅøÈöú
  37          void AvoidanceAndIndicate()
  38          {
  39   1        while(1)
  40   1        {
  41   2          // ÊãøÂú®Á©∫‰∏≠ ÊàñËÄÖ Á¢∞Âà∞ÈªëÁ∫ø Â∞±ÂÅú
  42   2          if(1==linspection && 1==rinspection)
  43   2          {
  44   3            CarRun('S','T');
  45   3            continue;
  46   3          }
  47   2          // ÈÅøÈöú
  48   2          if(1==lavoidance && 1==ravoidance && 0==linspection && 0==rinspection)  // Ê≤°ÊúâÈöúÁ¢ç,Âπ∂‰∏î‰∏çÂéãÁ∫ø
  49   2            CarRun('F','T');
  50   2          else if(0==lavoidance && 1==ravoidance)  // Â∑¶ËæπÊúâÈöúÁ¢ç
  51   2          {
  52   3            CarRun('R','T');
  53   3            Delay(turn_time);
  54   3          }
  55   2          else if(1==lavoidance && 0==ravoidance)  // Âè≥ËæπÊúâÈöúÁ¢ç
  56   2          {
  57   3            CarRun('L','T');
  58   3            Delay(turn_time);
  59   3          }
  60   2          else if(0==lavoidance && 0==ravoidance)  // ÂâçÈù¢ÊúâÈöúÁ¢ç
  61   2          {
  62   3            CarRun('L','B');
  63   3          }
  64   2          //Â∑°Á∫ø
  65   2          if(0==linspection && 1==rinspection)
  66   2            CarRunPro(127,-127);
  67   2          else if(1==linspection && 0==rinspection)
  68   2            CarRunPro(-127,127);
  69   2        }
  70   1        
  71   1      }
  72          
  73          
  74          /***********************************
  75          *ÂáΩÊï∞ÂêçÁß∞:void Delay(unsigned short num)
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 12:11:13 PAGE 4   

  76          *ÂáΩÊï∞ÂäüËÉΩ:Âª∂Êó∂
  77          *ÂèÇÊï∞ËØ¥Êòé:num Âª∂Êó∂Êó∂Èó¥ ÂÄºÊúÄÂ§ß255
  78          
  79          ***********************************/
  80          void Delay(unsigned short num)
  81          {
  82   1          unsigned int temp=0;
  83   1          while(num--)
  84   1          {
  85   2              temp=200;
  86   2              while(temp--);
  87   2          }
  88   1      }
  89          /**********************************
  90          ***********************************/
  91          
  92          
  93          /***********************************
  94          *ÂáΩÊï∞ÂêçÁß∞Ôºövoid CarRun(unsigned char dire)
  95          *ÂáΩÊï∞ÂäüËÉΩÔºöË°åËøõÊñπÂêëÊéßÂà∂
  96          *ÂèÇÊï∞ËØ¥ÊòéÔºödire ÊñπÂêë 'S'ÔºöÂÅúÊ≠¢   'F'ÔºöÂâç   'B'ÔºöÂêé   'L'ÔºöÂ∑¶   'R'ÔºöÂè≥
  97                     mode ËΩ¨ÂêëÊñπÂºè 'F'Ôºö‰∏ÄÂâç‰∏ÄÂÅú   'B'Ôºö‰∏ÄÂêé‰∏ÄÂÅú   'T'ÔºöÂù¶ÂÖãÂºèÔºå‰∏ÄÂâç‰∏ÄÂêé
  98          
  99          ***********************************/
 100          void CarRun(unsigned char dire,unsigned char mode)
 101          {
 102   1          switch (dire)
 103   1          {
 104   2              case 'S':             //ÂÅúÊ≠¢
 105   2                  CarRunPro(0,0);
 106   2                  break;
 107   2              case 'F':            //ÂâçËøõ
 108   2                  CarRunPro(127,127);
 109   2                  break;
 110   2              case 'B':            //ÂêéÈÄÄ 
 111   2                  CarRunPro(-128,-128);
 112   2            break;
 113   2              case 'L':            //Â∑¶ËΩ¨        
 114   2                  if('B'==mode)
 115   2                    CarRunPro(-128,0);
 116   2                  if('F'==mode)
 117   2                    CarRunPro(0,127);
 118   2                  else
 119   2                    CarRunPro(-128,127);
 120   2            break;
 121   2              case 'R':            //Âè≥ËΩ¨
 122   2                  if('B'==mode)
 123   2                    CarRunPro(0,-128);
 124   2                  if('F'==mode)
 125   2                    CarRunPro(127,0);
 126   2                  else
 127   2                    CarRunPro(127,-128);
 128   2                  break;
 129   2          }
 130   1      }
 131          
 132          /**********************************
 133          ***********************************/
 134          
 135          /***********************************
 136          *ÂáΩÊï∞ÂêçÁß∞Ôºövoid CarRunPro(signed char left_rate,signed char right_rate)
 137          *ÂáΩÊï∞ÂäüËÉΩÔºöË°åËøõÊñπÂêëÁöÑÈ´òÁ∫ßÊéßÂà∂
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/24/2020 12:11:13 PAGE 5   

 138          *ÂèÇÊï∞ËØ¥ÊòéÔºöleft_rate/right_rate(-128~127)Ë°®Á§∫Â∑¶/Âè≥ËΩÆË∑ëÁöÑÈÄüÂ∫¶,0/-1Ë°®Á§∫ÂÆåÂÖ®‰∏çËøêÂä®,ÂÆûÈô
             -Ö‰∏ä,Âè™ÊúâÊé•Ëøë127ËÉΩÈ©±Âä®
 139          
 140          ***********************************/
 141          void CarRunPro(signed char left_rate,signed char right_rate)
 142          {
 143   1        static signed char l=0,r=0;
 144   1        moto_RF=0<right_rate && 0==r;
 145   1        moto_RB=-1>right_rate && 0==r;
 146   1        moto_LF=0<left_rate && 0==l;
 147   1        moto_LB=-1>left_rate && 0==l;
 148   1        led_S=!((0==left_rate||-1==left_rate)&&(0==right_rate||-1==right_rate));// Â∑¶Âè≥ÁöÜÊ≠¢
 149   1        led_LF=!(0<right_rate&&!(0<left_rate));// Âè≥ËøõÂ∑¶ËΩ¨
 150   1        led_LB=!(-1>left_rate&&!(-1>right_rate));// Â∑¶ÈÄÄÂ∑¶ËΩ¨
 151   1        led_B=!(-1>left_rate&&-1>right_rate);// ÂêéÈÄÄ
 152   1        led_RB=!(!(-1>left_rate)&&-1>right_rate);// Âè≥ÈÄÄÂè≥ËΩ¨
 153   1        led_RF=!(0<left_rate&&!(0<left_rate));// Â∑¶ËøõÂè≥ËΩ¨
 154   1        led_F=!(0<left_rate&&0<right_rate);// ÂâçËøõ
 155   1        l++;
 156   1        r++;
 157   1        l%=128-ABS_NOT(left_rate);
 158   1        r%=128-ABS_NOT(right_rate);
 159   1      }
 160          /**********************************
 161          ***********************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    662    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
