C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 19:21:31 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE AVOIDANCEANDINDICATE
OBJECT MODULE PLACED IN .\Objects\AvoidanceAndIndicate.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE AvoidanceAndIndicate.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\AvoidanceAndIndicate.lst) TABS(2) OBJECT(.\Objects\AvoidanceAndIndicate.obj)

line level    source

   1          #include "reg52.h"  // keilä¸‹è¯·è§£é™¤è¿™ä¸ªçš„æ³¨é‡Š
   2          #define ABS_NOT(x) (x<0?~x:x)
   3          #define digit P0
   4          // æ•°å­—ç¯
   5          //sbit led_S=P0^1;  // ä¸­é—´æ 
   6          //sbit led_LF=P0^2;  // å·¦å‰æ 
   7          //sbit led_LB=P0^3;  // å·¦åŽæ 
   8          //sbit led_B=P0^4;  // åŽæ 
   9          //sbit led_RB=P0^5;  // å³åŽæ 
  10          //sbit led_RF=P0^6;  // å³å‰æ 
  11          //sbit led_F=P0^7;  // å‰æ 
  12          // é©¬è¾¾
  13          sbit moto_RF=P1^6;  // å³è½®å‘å‰    
  14          sbit moto_RB=P1^5;  // å³è½®å‘åŽ
  15          sbit moto_LF=P1^4;  // å·¦è½®å‘å‰
  16          sbit moto_LB=P1^3;  // å·¦è½®å‘åŽ
  17          // çº¢å¤–é¿éšœä¸²å£,æœ‰éšœç¢ä¸º0
  18          sbit linfrared=P3^4;  // å·¦çº¢å¤–
  19          sbit rinfrared=P3^5;  // å³çº¢å¤–
  20          // å·¡çº¿ä¸²å£, åŽ‹çº¿ä¸º0
  21          sbit llp=P3^7;  // å·¦å·¡çº¿
  22          sbit rlp=P3^6;  // å³å·¡çº¿
  23          void Delay(unsigned short);
  24          void Avoidance();
  25          void CarRunPro(char left_rate,char right_rate);
  26          void FlashLightStatus();
  27          void Patrol();
  28          
  29          int main(void)
  30          {
  31   1          
  32   1          while(1)
  33   1          {
  34   2            Patrol();
  35   2            FlashLightStatus();
  36   2          }
  37   1      }
  38          
  39          // é¿éšœ
  40          void Avoidance()
  41          {
  42   1          /*
  43   1              // é¿éšœ
  44   1              if(1==linfrared && 1==rinfrared && 0==llp && 0==rlp)  // æ²¡æœ‰éšœç¢,å¹¶ä¸”ä¸åŽ‹çº¿
  45   1                  CarRunPro('F','T');
  46   1              else if(0==linfrared && 1==rinfrared)  // å·¦è¾¹æœ‰éšœç¢
  47   1              {
  48   1                  CarRun('R','T');
  49   1                  //Delay(turn_time);
  50   1              }
  51   1              else if(1==linfrared && 0==rinfrared)  // å³è¾¹æœ‰éšœç¢
  52   1              {
  53   1                  CarRun('L','T');
  54   1                  //Delay(turn_time);
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 19:21:31 PAGE 2   

  55   1              }
  56   1              else if(0==linfrared && 0==rinfrared)  // å‰é¢æœ‰éšœç¢
  57   1              {
  58   1                  CarRun('L','B');
  59   1              }
  60   1              //å·¡çº¿
  61   1              if(0==llp && 1==rlp)
  62   1                  CarRunPro(126,-126);
  63   1              else if(1==llp && 0==rlp)
  64   1                  CarRunPro(-126,126);
  65   1          }
  66   1      */
  67   1      }
  68          
  69          //å³å…‰æ„Ÿå·¡çº¿
  70          void Patrol()
  71          {
  72   1          if(1==llp)  // å¦‚æžœå·¦å…‰æ„Ÿé‡åˆ°é»‘çº¿
  73   1          {
  74   2              CarRunPro(0,0);  // åœæ­¢è¿è¡Œ
  75   2              return;
  76   2          }
  77   1          switch(1==rlp){
  78   2              case 0:  // å³å…‰æ„Ÿæ˜¯ç™½è‰²
  79   2                  CarRunPro(127,0);  // å¾€å³è½¬åœˆ
  80   2                  break;
  81   2              case 1:  // å³å…‰æ„Ÿæ˜¯é»‘è‰²
  82   2                  CarRunPro(0,127);  // å¾€å·¦è½¬åœˆ
  83   2                  break;
  84   2          }
  85   1      }
  86          
  87          
  88          /***********************************
  89          *å‡½æ•°åç§°:void Delay(unsigned short num)
  90          *å‡½æ•°åŠŸèƒ½:å»¶æ—¶
  91          *å‚æ•°è¯´æ˜Ž:num å»¶æ—¶æ—¶é—´ å€¼æœ€å¤§255
  92          
  93          ***********************************/
  94          void Delay(unsigned short num)
  95          {
  96   1          unsigned int temp=0;
  97   1          while(num--)
  98   1          {
  99   2              temp=2000;
 100   2              while(temp--);
 101   2          }
 102   1      }
 103          /**********************************
 104          ***********************************/
 105          
 106          /***********************************
 107          *å‡½æ•°åç§°ï¼švoid CarRunPro(char left_rate,char right_rate)
 108          *å‡½æ•°åŠŸèƒ½ï¼šè¡Œè¿›æ–¹å‘çš„é«˜çº§æŽ§åˆ¶
 109          *å‚æ•°è¯´æ˜Žï¼šleft_rate/right_rate(-128~127)è¡¨ç¤ºå·¦/å³è½®è·‘çš„é€Ÿåº¦,æ•°å€¼å¤ªå°å¯èƒ½ä¼šæ— æ³•é©±å
             -Š¨,0/-1è¡¨ç¤ºå®Œå…¨ä¸è¿åŠ¨
 110          
 111          ***********************************/
 112          void CarRunPro(char left_rate,char right_rate)
 113          {
 114   1          static char l=0,r=0;
 115   1          if(l <= ABS_NOT(left_rate)){
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 19:21:31 PAGE 3   

 116   2              if(left_rate > 0){
 117   3                  moto_LF = 1;
 118   3                  moto_LB = 0;
 119   3              }else if(left_rate < -1){
 120   3                  moto_LB = 1;
 121   3                  moto_LF = 0;
 122   3              }else{
 123   3                  moto_LB = 0;
 124   3                  moto_LF = 0;
 125   3              }
 126   2          }else{
 127   2              moto_LB = 0;
 128   2              moto_LF = 0;
 129   2          }
 130   1          if(r <= ABS_NOT(left_rate)){
 131   2              if(right_rate>0){
 132   3                  moto_RF = 1;
 133   3                  moto_RB = 0;
 134   3              }else if(right_rate<-1){
 135   3                  moto_RB = 1;
 136   3                  moto_RF = 0;
 137   3              }else{
 138   3                  moto_RB = 0;
 139   3                  moto_RF = 0;
 140   3              }
 141   2          }else{
 142   2              moto_RB = 0;
 143   2              moto_RB = 0;
 144   2          }
 145   1          l++;
 146   1          r++;
 147   1          l%=128;
 148   1          r%=128;
 149   1      }
 150          /**********************************
 151          ***********************************/
 152          
 153          /***********************************
 154          *å‡½æ•°åç§°ï¼švoid FlashLightStatus()
 155          *å‡½æ•°åŠŸèƒ½ï¼šåˆ·æ–°å°è½¦æ•°å­—ç¯, æŒ‡ç¤ºå°è½¦è¿è¡ŒçŠ¶æ€
 156          *å‚æ•°è¯´æ˜Žï¼šæ— å‚æ•°
 157          
 158          ***********************************/
 159          void FlashLightStatus()
 160          {
 161   1          int status;
 162   1          status=1*(1==moto_RF)+2*(1==moto_RB)+3*(1==moto_LF)+6*(1==moto_LB);
 163   1          switch(status){
 164   2              case 0:
 165   2                  digit=0xFD;  // ä¸­
 166   2              case 1:
 167   2                  digit=0xBF;  // å³å‰
 168   2              case 2:
 169   2                  digit=0xDF;  // å³åŽ
 170   2              case 3:
 171   2                  digit=0xFB;  // å·¦å‰
 172   2              case 4:
 173   2                  digit=0x7F;  // å‰
 174   2              case 6:
 175   2                  digit=0xF7;  // å·¦åŽ
 176   2              case 7:
 177   2                  digit=0xB7;  // å³å‰å·¦åŽ
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 19:21:31 PAGE 4   

 178   2              case 8:
 179   2                  digit=0xD7;  // åŽ
 180   2          }
 181   1      }
 182          /**********************************
 183          ***********************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    370    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
