C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 20:58:23 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE AVOIDANCEANDINDICATE
OBJECT MODULE PLACED IN .\Objects\AvoidanceAndIndicate.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE AvoidanceAndIndicate.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\AvoidanceAndIndicate.lst) TABS(2) OBJECT(.\Objects\AvoidanceAndIndicate.obj)

line level    source

   1          #include "reg52.h"  // keilä¸‹è¯·è§£é™¤è¿™ä¸ªçš„æ³¨é‡Š
   2          #define ABS_NOT(x) (x<0?~x:x)
   3          #define digit P0
   4          // æ•°å­—ç¯
   5          //sbit led_S=P0^1;  // ä¸­é—´æ 
   6          //sbit led_LF=P0^2;  // å·¦å‰æ 
   7          //sbit led_LB=P0^3;  // å·¦åŽæ 
   8          //sbit led_B=P0^4;  // åŽæ 
   9          //sbit led_RB=P0^5;  // å³åŽæ 
  10          //sbit led_RF=P0^6;  // å³å‰æ 
  11          //sbit led_F=P0^7;  // å‰æ 
  12          // é©¬è¾¾
  13          sbit moto_RF=P1^6;  // å³è½®å‘å‰    
  14          sbit moto_RB=P1^5;  // å³è½®å‘åŽ
  15          sbit moto_LF=P1^4;  // å·¦è½®å‘å‰
  16          sbit moto_LB=P1^3;  // å·¦è½®å‘åŽ
  17          // çº¢å¤–é¿éšœä¸²å£,æœ‰éšœç¢ä¸º0
  18          sbit linfrared=P3^4;  // å·¦çº¢å¤–
  19          sbit rinfrared=P3^5;  // å³çº¢å¤–
  20          // å·¡çº¿ä¸²å£, åŽ‹çº¿ä¸º0
  21          sbit llp=P3^7;  // å·¦å·¡çº¿
  22          sbit rlp=P3^6;  // å³å·¡çº¿
  23          void Delay(unsigned short);
  24          void Avoidance();
  25          void CarRunPro(char left_rate,char right_rate);
  26          void FlashLightStatus();
  27          void LPatrol();
  28          
  29          int main(void)
  30          {
  31   1          
  32   1          while(1)
  33   1          {
  34   2            LPatrol();
  35   2            FlashLightStatus();
  36   2          }
  37   1      }
  38          
  39          // é¿éšœ
  40          void Avoidance()
  41          {
  42   1          /*
  43   1              // é¿éšœ
  44   1              if(1==linfrared && 1==rinfrared && 0==llp && 0==rlp)  // æ²¡æœ‰éšœç¢,å¹¶ä¸”ä¸åŽ‹çº¿
  45   1                  CarRunPro('F','T');
  46   1              else if(0==linfrared && 1==rinfrared)  // å·¦è¾¹æœ‰éšœç¢
  47   1              {
  48   1                  CarRun('R','T');
  49   1                  //Delay(turn_time);
  50   1              }
  51   1              else if(1==linfrared && 0==rinfrared)  // å³è¾¹æœ‰éšœç¢
  52   1              {
  53   1                  CarRun('L','T');
  54   1                  //Delay(turn_time);
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 20:58:23 PAGE 2   

  55   1              }
  56   1              else if(0==linfrared && 0==rinfrared)  // å‰é¢æœ‰éšœç¢
  57   1              {
  58   1                  CarRun('L','B');
  59   1              }
  60   1              //å·¡çº¿
  61   1              if(0==llp && 1==rlp)
  62   1                  CarRunPro(126,-126);
  63   1              else if(1==llp && 0==rlp)
  64   1                  CarRunPro(-126,126);
  65   1          }
  66   1      */
  67   1      }
  68          
  69          //å³å…‰æ„Ÿå·¡çº¿
  70          void LPatrol()
  71          {
  72   1        if(1==llp && 1==rlp)  // å¦‚æžœå·¦å…‰æ„Ÿé‡åˆ°é»‘çº¿å°±åœï¼Œä»¥é˜²ä¸‡ä¸€ï¼Œä¹Ÿæ£€æµ‹ä¸€ä¸‹å³å…‰æ„Ÿæ˜¯å
             -¦åŽ‹åœ¨é»‘çº¿ä¸Š
  73   1          {
  74   2              CarRunPro(0,0);  // åœæ­¢è¿è¡Œ
  75   2              return;
  76   2          }
  77   1          switch(1==rlp){
  78   2              case 0:  // å³å…‰æ„Ÿæ˜¯ç™½è‰²
  79   2                  CarRunPro(100,0);  // å¾€å³è½¬åœˆ
  80   2                  break;
  81   2              case 1:  // å³å…‰æ„Ÿæ˜¯é»‘è‰²
  82   2                  CarRunPro(0,100);  // å¾€å·¦è½¬åœˆ
  83   2                  break;
  84   2          }
  85   1          switch(1==llp){
  86   2              case 1:  // ä¸‡ä¸€åˆ°è¿™é‡Œå·¦å…‰æ„Ÿè¿˜èƒ½æ˜¯1, å°±è¯´æ˜Žè„±è½¨äº†, è¿™æ—¶å€™ç»™ä»–ä¸ªå¾®è°ƒ
  87   2                  CarRunPro(0,100);  // å¾€å·¦è½¬åœˆ
  88   2                  break;
  89   2          }
  90   1      }
  91          
  92          
  93          /***********************************
  94          *å‡½æ•°åç§°:void Delay(unsigned short num)
  95          *å‡½æ•°åŠŸèƒ½:å»¶æ—¶
  96          *å‚æ•°è¯´æ˜Ž:num å»¶æ—¶æ—¶é—´ å€¼æœ€å¤§255
  97          
  98          ***********************************/
  99          void Delay(unsigned short num)
 100          {
 101   1          unsigned int temp=0;
 102   1          while(num--)
 103   1          {
 104   2              temp=2000;
 105   2              while(temp--);
 106   2          }
 107   1      }
 108          /**********************************
 109          ***********************************/
 110          
 111          /***********************************
 112          *å‡½æ•°åç§°ï¼švoid CarRunPro(char left_rate,char right_rate)
 113          *å‡½æ•°åŠŸèƒ½ï¼šè¡Œè¿›æ–¹å‘çš„é«˜çº§æŽ§åˆ¶
 114          *å‚æ•°è¯´æ˜Žï¼šleft_rate/right_rate(-128~127)è¡¨ç¤ºå·¦/å³è½®è·‘çš„é€Ÿåº¦,æ•°å€¼å¤ªå°å¯èƒ½ä¼šæ— æ³•é©±å
             -Š¨,0/-1è¡¨ç¤ºå®Œå…¨ä¸è¿åŠ¨
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 20:58:23 PAGE 3   

 115          
 116          ***********************************/
 117          void CarRunPro(char left_rate,char right_rate)
 118          {
 119   1          static char l=0,r=0;
 120   1          if(l <= ABS_NOT(left_rate)){
 121   2              if(left_rate > 0){
 122   3                  moto_LF = 1;
 123   3                  moto_LB = 0;
 124   3              }else if(left_rate < -1){
 125   3                  moto_LB = 1;
 126   3                  moto_LF = 0;
 127   3              }else{
 128   3                  moto_LB = 0;
 129   3                  moto_LF = 0;
 130   3              }
 131   2          }else{
 132   2              moto_LB = 0;
 133   2              moto_LF = 0;
 134   2          }
 135   1          if(r <= ABS_NOT(left_rate)){
 136   2              if(right_rate>0){
 137   3                  moto_RF = 1;
 138   3                  moto_RB = 0;
 139   3              }else if(right_rate<-1){
 140   3                  moto_RB = 1;
 141   3                  moto_RF = 0;
 142   3              }else{
 143   3                  moto_RB = 0;
 144   3                  moto_RF = 0;
 145   3              }
 146   2          }else{
 147   2              moto_RB = 0;
 148   2              moto_RB = 0;
 149   2          }
 150   1          l++;
 151   1          r++;
 152   1          l%=128;
 153   1          r%=128;
 154   1      }
 155          /**********************************
 156          ***********************************/
 157          
 158          /***********************************
 159          *å‡½æ•°åç§°ï¼švoid FlashLightStatus()
 160          *å‡½æ•°åŠŸèƒ½ï¼šåˆ·æ–°å°è½¦æ•°å­—ç¯, æŒ‡ç¤ºå°è½¦è¿è¡ŒçŠ¶æ€
 161          *å‚æ•°è¯´æ˜Žï¼šæ— å‚æ•°
 162          
 163          ***********************************/
 164          void FlashLightStatus()
 165          {
 166   1          int status;
 167   1          status=1*(1==moto_RF)+2*(1==moto_RB)+3*(1==moto_LF)+6*(1==moto_LB);
 168   1          switch(status){
 169   2              case 0:
 170   2                  digit=0xFD;  // ä¸­
 171   2                  break;
 172   2              case 1:
 173   2                  digit=0xBF;  // å³å‰
 174   2                  break;
 175   2              case 2:
 176   2                  digit=0xDF;  // å³åŽ
C51 COMPILER V9.54   AVOIDANCEANDINDICATE                                                  07/25/2020 20:58:23 PAGE 4   

 177   2                  break;
 178   2              case 3:
 179   2                  digit=0xFB;  // å·¦å‰
 180   2                  break;
 181   2              case 4:
 182   2                  digit=0x7F;  // å‰
 183   2                  break;
 184   2              case 6:
 185   2                  digit=0xF7;  // å·¦åŽ
 186   2                  break;
 187   2              case 7:
 188   2                  digit=0xB7;  // å³å‰å·¦åŽ
 189   2                  break;
 190   2              case 8:
 191   2                  digit=0xD7;  // åŽ
 192   2                  break;
 193   2          }
 194   1      }
 195          /**********************************
 196          ***********************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    400    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
